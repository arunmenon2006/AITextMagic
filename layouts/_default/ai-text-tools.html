{{ define "title" }}AI Text Tools - {{ .Site.Title }}{{ end }}

{{ define "description" }}Free AI-powered text summarization, paraphrasing, and sentiment analysis tools running locally in your browser.{{ end }}

{{ define "head" }}
<link rel="stylesheet" href="{{ "css/ai-text-tools.css" | relURL }}">
{{ end }}

{{ define "main" }}
<div class="container mx-auto px-4 py-8">
    <div class="text-center mb-12">
        <h1 class="text-4xl font-bold text-gray-800 mb-4">ü§ñ AI Text Tools</h1>
        <p class="text-xl text-gray-600 mb-6">Summarize, paraphrase, and analyze text ‚Äî all in your browser, powered by TensorFlow.js.<br><span class="text-sm text-gray-500">No server, no sign-up, no limits.</span></p>
        <div class="flex flex-wrap justify-center gap-3 mb-8">
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800">üöÄ Free</span>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">üîí Privacy First</span>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-purple-100 text-purple-800">üåê Works Offline</span>
            <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-indigo-100 text-indigo-800">‚ö° Lightning Fast</span>
        </div>
    </div>

    <!-- Model status -->
    <div id="modelStatus" class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-8 flex items-center gap-3">
        <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"></div>
        <span class="text-blue-800">Loading AI models... This may take a minute on first visit.</span>
    </div>

    <!-- Modern Tabs UI -->
    <div class="bg-white rounded-lg shadow-lg overflow-hidden">
        <div class="border-b border-gray-200">
            <nav class="flex flex-wrap md:flex-nowrap space-x-0 md:space-x-8 px-2 md:px-6" aria-label="Tabs">
                <button class="ai-tab active" data-tab="summarize">
                    <span class="text-lg mr-2">üìù</span> Summarize
                </button>
                <button class="ai-tab" data-tab="paraphrase">
                    <span class="text-lg mr-2">üîÑ</span> Paraphrase
                </button>
                <button class="ai-tab" data-tab="sentiment">
                    <span class="text-lg mr-2">üòä</span> Sentiment
                </button>
            </nav>
        </div>
        <div class="p-6">
            <!-- Summarize Tab -->
            <div id="summarize" class="ai-tab-content active">
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6 flex items-center gap-2">
                    <span class="font-semibold text-amber-800">üí° Tip:</span>
                    <span class="text-amber-800">Use 100-500 words for best summary. All processing is local.</span>
                </div>
                <div class="space-y-6">
                    <div>
                        <label for="summarize-input" class="block text-sm font-medium text-gray-700 mb-2">Text to Summarize:</label>
                        <textarea id="summarize-input" class="ai-textarea" rows="6" placeholder="Paste your article, essay, or long text here..."></textarea>
                        <div class="text-right text-sm text-gray-500 mt-1">Word count: <span id="summarize-count">0</span></div>
                    </div>
                    <div class="flex flex-wrap items-center gap-4">
                        <button class="ai-btn ai-btn-primary" onclick="processText('summarize')" id="summarize-btn" disabled>üìù Summarize</button>
                        <select id="summary-length" class="ai-select">
                            <option value="short">Short (2-3 sentences)</option>
                            <option value="medium" selected>Medium (4-5 sentences)</option>
                            <option value="long">Detailed (6-8 sentences)</option>
                        </select>
                        <button class="ai-btn ai-btn-secondary" onclick="clearText('summarize')">Clear</button>
                    </div>
                    <div class="ai-loading hidden" id="summarize-loading">
                        <div class="flex items-center justify-center p-8">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-4"></div>
                            <span class="text-blue-600 font-medium">Summarizing your text...</span>
                        </div>
                    </div>
                    <div id="summarize-result"></div>
                </div>
            </div>
            <!-- Paraphrase Tab -->
            <div id="paraphrase" class="ai-tab-content">
                <div class="bg-amber-50 border border-amber-200 rounded-lg p-4 mb-6 flex items-center gap-2">
                    <span class="font-semibold text-amber-800">üí° Note:</span>
                    <span class="text-amber-800">Paraphrasing uses synonyms and basic sentence structure variation locally.</span>
                </div>
                <div class="space-y-6">
                    <div>
                        <label for="paraphrase-input" class="block text-sm font-medium text-gray-700 mb-2">Text to Paraphrase:</label>
                        <textarea id="paraphrase-input" class="ai-textarea" rows="6" placeholder="Enter sentences or paragraphs to paraphrase..."></textarea>
                        <div class="text-right text-sm text-gray-500 mt-1">Word count: <span id="paraphrase-count">0</span></div>
                    </div>
                    <div class="flex flex-wrap items-center gap-4">
                        <button class="ai-btn ai-btn-primary" onclick="processText('paraphrase')" id="paraphrase-btn" disabled>üîÑ Paraphrase</button>
                        <select id="paraphrase-strength" class="ai-select">
                            <option value="light">Light</option>
                            <option value="medium" selected>Medium</option>
                            <option value="heavy">Heavy</option>
                        </select>
                        <button class="ai-btn ai-btn-secondary" onclick="clearText('paraphrase')">Clear</button>
                    </div>
                    <div class="ai-loading hidden" id="paraphrase-loading">
                        <div class="flex items-center justify-center p-8">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-4"></div>
                            <span class="text-blue-600 font-medium">Rephrasing your text...</span>
                        </div>
                    </div>
                    <div id="paraphrase-result"></div>
                </div>
            </div>
            <!-- Sentiment Analysis Tab -->
            <div id="sentiment" class="ai-tab-content">
                <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6 flex items-center gap-2">
                    <span class="font-semibold text-blue-800">üí° Feature:</span>
                    <span class="text-blue-800">Analyze the emotional tone and sentiment locally.</span>
                </div>
                <div class="space-y-6">
                    <div>
                        <label for="sentiment-input" class="block text-sm font-medium text-gray-700 mb-2">Text to Analyze:</label>
                        <textarea id="sentiment-input" class="ai-textarea" rows="6" placeholder="Enter text to analyze sentiment..."></textarea>
                        <div class="text-right text-sm text-gray-500 mt-1">Word count: <span id="sentiment-count">0</span></div>
                    </div>
                    <div class="flex flex-wrap items-center gap-4">
                        <button class="ai-btn ai-btn-primary" onclick="processText('sentiment')" id="sentiment-btn">üòä Analyze</button>
                        <button class="ai-btn ai-btn-secondary" onclick="clearText('sentiment')">Clear</button>
                    </div>
                    <div class="ai-loading hidden" id="sentiment-loading">
                        <div class="flex items-center justify-center p-8">
                            <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mr-4"></div>
                            <span class="text-blue-600 font-medium">Analyzing sentiment...</span>
                        </div>
                    </div>
                    <div id="sentiment-result"></div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- TensorFlow.js Scripts -->
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@4.10.0/dist/tf.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/universal-sentence-encoder@1.3.3/dist/universal-sentence-encoder.min.js"></script>
<script>
// --- JS logic is unchanged, see previous code block ---
/* ... (entire JS block from previous code is unchanged, just moved below the HTML) ... */

// Global variables
let useModel = null;
let modelLoaded = false;
const modelStatus = document.getElementById('modelStatus');

// Synonyms database for paraphrasing
const synonyms = {
    'good': ['excellent', 'great', 'fine', 'wonderful', 'outstanding'],
    'bad': ['poor', 'terrible', 'awful', 'horrible', 'dreadful'],
    'big': ['large', 'huge', 'massive', 'enormous', 'giant'],
    'small': ['tiny', 'little', 'miniature', 'compact', 'petite'],
    'fast': ['quick', 'rapid', 'swift', 'speedy', 'hasty'],
    'slow': ['sluggish', 'gradual', 'leisurely', 'unhurried', 'delayed'],
    'happy': ['joyful', 'cheerful', 'delighted', 'pleased', 'content'],
    'sad': ['unhappy', 'sorrowful', 'depressed', 'melancholy', 'gloomy'],
    'important': ['crucial', 'vital', 'essential', 'significant', 'critical'],
    'easy': ['simple', 'effortless', 'straightforward', 'uncomplicated', 'basic'],
    'difficult': ['challenging', 'hard', 'tough', 'complex', 'complicated'],
    'nice': ['pleasant', 'lovely', 'delightful', 'enjoyable', 'agreeable'],
    'interesting': ['fascinating', 'engaging', 'captivating', 'intriguing', 'compelling'],
    'beautiful': ['gorgeous', 'stunning', 'attractive', 'lovely', 'magnificent']
};

// Initialize TensorFlow.js models
async function initializeModels() {
    try {
        modelStatus.innerHTML = `
            <div class="flex items-center">
                <div class="animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600 mr-3"></div>
                <span class="text-blue-800">Loading Universal Sentence Encoder... (This may take 30-60 seconds)</span>
            </div>
        `;
        useModel = await use.load();
        modelLoaded = true;
        modelStatus.innerHTML = `
            <div class="flex items-center">
                <svg class="w-5 h-5 text-green-600 mr-3" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"></path>
                </svg>
                <span class="text-green-800">AI models loaded! Ready to process text locally.</span>
            </div>
        `;
        modelStatus.className = 'bg-green-50 border border-green-200 rounded-lg p-4 mb-8 flex items-center gap-3';
        document.querySelectorAll('button[id$="-btn"]:not([onclick*="sentiment"])').forEach(btn => {
            btn.disabled = false;
            btn.classList.remove('opacity-50', 'cursor-not-allowed');
        });
    } catch (error) {
        console.error('Error loading models:', error);
        modelStatus.innerHTML = `
            <div class="flex items-center">
                <svg class="w-5 h-5 text-red-600 mr-3" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                </svg>
                <span class="text-red-800">Failed to load AI models. Some features may not work.</span>
            </div>
        `;
        modelStatus.className = 'bg-red-50 border border-red-200 rounded-lg p-4 mb-8 flex items-center gap-3';
    }
}

// Tab switching
document.querySelectorAll('.ai-tab').forEach(tab => {
    tab.addEventListener('click', (e) => {
        e.preventDefault();
        document.querySelectorAll('.ai-tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.ai-tab-content').forEach(pane => pane.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.getAttribute('data-tab')).classList.add('active');
    });
});

// Word count tracking
['summarize', 'paraphrase', 'sentiment'].forEach(type => {
    const input = document.getElementById(`${type}-input`);
    const counter = document.getElementById(`${type}-count`);
    input.addEventListener('input', () => {
        const wordCount = input.value.trim() === '' ? 0 : input.value.trim().split(/\s+/).length;
        counter.textContent = wordCount;
    });
});

// Main processing function
async function processText(type) {
    const input = document.getElementById(`${type}-input`);
    const loading = document.getElementById(`${type}-loading`);
    const resultDiv = document.getElementById(`${type}-result`);
    const btn = document.getElementById(`${type}-btn`);
    const text = input.value.trim();
    if (!text) { alert('Please enter some text first!'); return; }
    if (!modelLoaded && type !== 'sentiment') {
        alert('AI models are still loading. Please wait a moment and try again.');
        return;
    }
    loading.classList.remove('hidden');
    resultDiv.innerHTML = '';
    btn.disabled = true; btn.classList.add('opacity-50', 'cursor-not-allowed');
    try {
        let result = '';
        switch(type) {
            case 'summarize': result = await summarizeWithTensorFlow(text); break;
            case 'paraphrase': result = await paraphraseText(text); break;
            case 'sentiment': result = await analyzeSentiment(text); break;
        }
        displayResult(type, result);
    } catch (error) {
        console.error('Processing error:', error);
        displayError(type, 'An error occurred while processing your text. Please try again.');
    } finally {
        loading.classList.add('hidden');
        btn.disabled = false; btn.classList.remove('opacity-50', 'cursor-not-allowed');
    }
}
function displayResult(type, result) {
    const resultDiv = document.getElementById(`${type}-result`);
    const wordCount = result.trim().split(/\s+/).length;
    resultDiv.innerHTML = `
        <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg mt-6">
            <div class="bg-blue-600 text-white px-6 py-4 rounded-t-lg flex justify-between items-center">
                <h3 class="text-lg font-semibold">‚ú® Result</h3>
                <button class="bg-white text-blue-600 px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-50 transition-colors"
                    onclick="copyResult('${type}')">üìã Copy</button>
            </div>
            <div class="p-6">
                <div id="${type}-result-text" class="text-gray-800 leading-relaxed">${result.replace(/\n/g, '<br>')}</div>
                <div class="text-sm text-gray-500 mt-4">Result word count: ${wordCount}</div>
            </div>
        </div>
    `;
}
function displayError(type, errorMessage) {
    const resultDiv = document.getElementById(`${type}-result`);
    resultDiv.innerHTML = `
        <div class="bg-red-50 border border-red-200 rounded-lg p-4 mt-6">
            <div class="flex items-center">
                <svg class="w-5 h-5 text-red-600 mr-3" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                </svg>
                <span class="text-red-800">${errorMessage}</span>
            </div>
        </div>
    `;
}
function copyResult(type) {
    const resultElement = document.getElementById(`${type}-result-text`);
    const resultText = resultElement.textContent || resultElement.innerText;
    navigator.clipboard.writeText(resultText).then(() => {
        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg z-50';
        notification.innerHTML = '‚úÖ Result copied to clipboard!';
        document.body.appendChild(notification);
        setTimeout(() => notification.remove(), 3000);
    }).catch(() => {
        const textarea = document.createElement('textarea');
        textarea.value = resultText;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        alert('‚úÖ Result copied to clipboard!');
    });
}
function clearText(type) {
    document.getElementById(`${type}-input`).value = '';
    document.getElementById(`${type}-result`).innerHTML = '';
    document.getElementById(`${type}-count`).textContent = '0';
}
// AI processing logic
async function summarizeWithTensorFlow(text) {
    if (!useModel) return basicSummarize(text);
    try {
        const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 10);
        if (sentences.length <= 2) return text + '\n\nüìù Text is already concise!';
        const embeddings = await useModel.embed(sentences);
        const embeddingArray = await embeddings.array();
        const overallEmbedding = await useModel.embed([text]);
        const overallArray = await overallEmbedding.array();
        const similarities = embeddingArray.map(sentEmb => cosineSimilarity(sentEmb, overallArray[0]));
        const lengthSetting = document.getElementById('summary-length').value;
        let numSentences = Math.max(1, Math.floor(sentences.length * 0.3));
        if (lengthSetting === 'short') numSentences = Math.max(1, Math.min(2, Math.floor(sentences.length * 0.2)));
        if (lengthSetting === 'long') numSentences = Math.max(2, Math.floor(sentences.length * 0.5));
        const sentenceScores = sentences.map((sentence, index) => ({
            sentence: sentence.trim(),
            score: similarities[index],
            index: index
        }));
        sentenceScores.sort((a, b) => b.score - a.score);
        const selectedSentences = sentenceScores
            .slice(0, numSentences)
            .sort((a, b) => a.index - b.index)
            .map(item => item.sentence);
        embeddings.dispose();
        overallEmbedding.dispose();
        return selectedSentences.join('. ') + '.';
    } catch (error) {
        console.error('TensorFlow summarization error:', error);
        return basicSummarize(text);
    }
}
function basicSummarize(text) {
    const sentences = text.split(/[.!?]+/).filter(s => s.trim().length > 10);
    const lengthSetting = document.getElementById('summary-length').value;
    let keepSentences = Math.max(1, Math.floor(sentences.length * 0.3));
    if (lengthSetting === 'short') keepSentences = Math.max(1, Math.min(2, sentences.length));
    if (lengthSetting === 'long') keepSentences = Math.floor(sentences.length * 0.6);
    return sentences.slice(0, keepSentences).join('. ') + '.';
}
async function paraphraseText(text) {
    const strength = document.getElementById('paraphrase-strength').value;
    let result = text;
    try {
        result = replaceSynonyms(result, strength);
        if (strength === 'medium' || strength === 'heavy') {
            result = restructureSentences(result, strength);
        }
        return result;
    } catch (error) {
        console.error('Paraphrasing error:', error);
        return replaceSynonyms(text, 'light');
    }
}
function replaceSynonyms(text, strength) {
    let result = text;
    const replacementRatio = {
        'light': 0.2,
        'medium': 0.4,
        'heavy': 0.6
    };
    const ratio = replacementRatio[strength] || 0.3;
    for (const [word, synonymList] of Object.entries(synonyms)) {
        const regex = new RegExp(`\\b${word}\\b`, 'gi');
        if (regex.test(result) && Math.random() < ratio) {
            const synonym = synonymList[Math.floor(Math.random() * synonymList.length)];
            result = result.replace(regex, synonym);
        }
    }
    return result;
}
function restructureSentences(text, strength) {
    const sentences = text.split(/[.!?]+/).filter(s => s.trim());
    return sentences.map(sentence => {
        if (strength === 'heavy' && Math.random() < 0.5) {
            sentence = sentence.replace(/(\w+) is (\w+) by (\w+)/g, '$3 $2s $1');
            sentence = sentence.replace(/The (\w+) (\w+) the (\w+)/g, 'The $3 was $2ed by the $1');
        }
        if (Math.random() < 0.3) {
            if (sentence.trim().startsWith('This')) {
                sentence = sentence.replace(/^This/, 'It');
            } else if (sentence.trim().startsWith('It')) {
                sentence = sentence.replace(/^It/, 'This');
            }
        }
        return sentence.trim();
    }).join('. ') + '.';
}
async function analyzeSentiment(text) {
    const positiveWords = ['good', 'great', 'excellent', 'amazing', 'wonderful', 'fantastic', 'love', 'happy', 'joy', 'perfect', 'awesome', 'brilliant', 'outstanding', 'superb', 'magnificent'];
    const negativeWords = ['bad', 'terrible', 'awful', 'horrible', 'hate', 'sad', 'angry', 'disappointed', 'frustrated', 'annoying', 'disgusting', 'pathetic', 'useless', 'worst', 'dreadful'];
    const words = text.toLowerCase().split(/\W+/);
    let positiveCount = 0;
    let negativeCount = 0;
    words.forEach(word => {
        if (positiveWords.includes(word)) positiveCount++;
        if (negativeWords.includes(word)) negativeCount++;
    });
    const totalSentimentWords = positiveCount + negativeCount;
    let sentiment = 'Neutral';
    let confidence = 0;
    if (totalSentimentWords > 0) {
        const positiveRatio = positiveCount / totalSentimentWords;
        if (positiveRatio > 0.6) {
            sentiment = 'Positive';
            confidence = Math.min(95, 60 + (positiveRatio * 40));
        } else if (positiveRatio < 0.4) {
            sentiment = 'Negative';
            confidence = Math.min(95, 60 + ((1 - positiveRatio) * 40));
        } else {
            sentiment = 'Neutral';
            confidence = 50 + Math.random() * 20;
        }
    } else {
        confidence = 30 + Math.random() * 20;
    }
    const emoji = sentiment === 'Positive' ? 'üòä' : sentiment === 'Negative' ? 'üòî' : 'üòê';
    return `${emoji} <strong>Sentiment: ${sentiment}</strong><br><br>Confidence: ${confidence.toFixed(1)}%<br><br>Analysis:<br>‚Ä¢ Positive words found: ${positiveCount}<br>‚Ä¢ Negative words found: ${negativeCount}<br>‚Ä¢ Total words analyzed: ${words.length}<br><br>üìä This analysis uses basic word matching. For more accurate results, consider using advanced sentiment analysis APIs.`;
}
function cosineSimilarity(a, b) {
    const dotProduct = a.reduce((sum, val, i) => sum + val * b[i], 0);
    const magnitudeA = Math.sqrt(a.reduce((sum, val) => sum + val * val, 0));
    const magnitudeB = Math.sqrt(b.reduce((sum, val) => sum + val * val, 0));
    return dotProduct / (magnitudeA * magnitudeB);
}
document.addEventListener('DOMContentLoaded', function() {
    document.querySelectorAll('button[id$="-btn"]:not([onclick*="sentiment"])').forEach(btn => {
        btn.disabled = true;
        btn.classList.add('opacity-50', 'cursor-not-allowed');
    });
    initializeModels();
});
</script>
{{ end }}